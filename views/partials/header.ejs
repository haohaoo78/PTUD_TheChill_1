<!-- views/partials/header.ejs -->
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
          integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
          crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="/css/globals.css">

<div class="header-top">
    <!-- Bên trái: logo + tiêu đề -->
    <div class="header-brand">
        <div class="header-logo">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 3L2 9L12 15L22 9L12 3Z" fill="currentColor" fill-opacity="0.2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M2 15L12 21L22 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M2 12L12 18L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>
        <div class="header-title-wrapper">
            <div class="header-subtitle">BỘ GIÁO DỤC VÀ ĐÀO TẠO</div>
            <h1 class="header-title">HỆ THỐNG QUẢN LÝ HỌC SINH THPT</h1>
        </div>
    </div>

    <!-- Bên phải: hỗ trợ + thông báo + user -->
    <div class="header-actions">
        <button class="icon-btn" title="Trợ giúp">
            <i class="fa fa-question-circle"></i>
        </button>

        <button class="icon-btn">
            <i class="fa fa-bell"></i>
            <span class="notification-badge"></span>
        </button>

        <button class="user-menu">
            <div class="user-avatar">
                <i class="fas fa-user"></i>
            </div>
            <div class="user-info">
                <!-- Tên người dùng -->
                <div class="user-name">
                    <%= currentUser ? currentUser.hoTen : 'Xin chào' %>
                </div>

                <!-- Vai trò + lớp (nếu có) + trạng thái hoạt động -->
                <div class="user-role">
                    <%= currentUser ? currentUser.role : 'Bạn chưa đăng nhập' %>

                    <% if (currentUser && currentUser.tenLop) { %>
                        <% 
                            let lopText = '';
                            if (currentUser.loaiTaiKhoan.includes('Học sinh')) {
                                lopText = 'Lớp: ' + currentUser.tenLop;
                            } else if (currentUser.loaiTaiKhoan.includes('Giáo viên') && currentUser.isGVChuNhiem) {
                                lopText = 'Chủ nhiệm lớp: ' + currentUser.tenLop;
                            } else if (currentUser.loaiTaiKhoan.includes('Phụ huynh')) {
                                lopText = 'Con học lớp: ' + currentUser.tenLop;
                            }
                        %>
                        <% if (lopText) { %>
                            <span class="user-class">• <%= lopText %></span>
                        <% } %>
                    <% } %>

                    <!-- Chỉ hiển thị "Đang hoạt động" khi ĐÃ đăng nhập -->
                    <% if (currentUser) { %>
                        <span class="user-status">• Đang hoạt động</span>
                    <% } %>
                </div>
            </div>
            <i class="fas fa-chevron-down"></i>
        </button>
    </div>
</div>

<div class="header-bottom">
    <div class="header-info">
        <div class="info-left">
            Năm học: 2025-2026 • Học kỳ: I
        </div>
        <div class="info-right">
            Hôm nay: <span id="current-date"></span>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const now = new Date();
        const day = String(now.getDate()).padStart(2, '0');
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const year = now.getFullYear();
        const formattedDate = `${day}/${month}/${year}`;
        document.getElementById('current-date').textContent = formattedDate;
    });
</script>