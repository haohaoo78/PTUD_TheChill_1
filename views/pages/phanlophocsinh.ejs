<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ph√¢n l·ªõp h·ªçc sinh</title>
  <link rel="stylesheet" href="/css/phanlop.css" />
  
</head>
<body>
  <div class="phanlop-container">
    <div class="page-header">
      <h2>Ph√¢n l·ªõp h·ªçc sinh</h2>
      <p class="subtitle">Qu·∫£n l√Ω ph√¢n chia h·ªçc sinh v√†o c√°c l·ªõp theo kh·ªëi v√† t·ªï h·ª£p m√¥n</p>
    </div>

    <!-- Controls -->
    <div class="controls">
      <div class="control-group">
        <label for="khoi-select">Kh·ªëi:</label>
        <select id="khoi-select" class="form-select">
          <% khoiList.forEach(k => { %>
            <option value="<%= k.MaKhoi %>" <%= (k.MaKhoi === selectedKhoi) ? 'selected' : '' %>>
              <%= k.TenKhoi %>
            </option>
          <% }) %>
        </select>
        <small class="help-text">Ch·ªçn kh·ªëi ƒë·ªÉ ph√¢n l·ªõp</small>
      </div>

      <div class="control-group">
        <label for="max-size">Sƒ© s·ªë t·ªëi ƒëa:</label>
        <input type="number" id="max-size" class="form-input" min="20" max="50" value="35">
        <small class="help-text">T·ª´ 20-50 h·ªçc sinh/l·ªõp</small>
      </div>

      <div class="control-buttons">
        <button id="load-students" class="btn btn-primary">
          <span class="btn-icon"></span> T·∫£i d·ªØ li·ªáu
        </button>
        <button id="auto-assign" class="btn btn-secondary">
          <span class="btn-icon"></span> Ph√¢n b·ªï t·ª± ƒë·ªông
        </button>
        <button id="save-assign" class="btn btn-success">
          <span class="btn-icon"></span> L∆∞u ph√¢n b·ªï
        </button>
      </div>
    </div>

    <!-- Main Content -->
    <div class="content-wrapper">
      <!-- Students Panel -->
      <section class="students-panel">
        <div class="panel-header">
          <h3>Danh s√°ch h·ªçc sinh</h3>
          <span class="count-badge" id="students-count">0 h·ªçc sinh</span>
        </div>
        <div class="table-wrapper">
          <table id="students-table" class="data-table">
            <thead>
              <tr>
                <th>STT</th>
                <th>M√£ HS</th>
                <th>T√™n h·ªçc sinh</th>
                <th>Gi·ªõi t√≠nh</th>
                <th>T·ªï h·ª£p</th>
                <th>Tr·∫°ng th√°i</th>
                <th>L·ªõp</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="7" class="empty-state">
                  <div class="empty-icon">üìã</div>
                  <p>Nh·∫•n "T·∫£i d·ªØ li·ªáu" ƒë·ªÉ xem danh s√°ch</p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Classes Panel -->
      <section class="classes-panel">
        <div class="panel-header">
          <h3>Danh s√°ch l·ªõp</h3>
          <span class="count-badge" id="classes-count">0 l·ªõp</span>
        </div>
        <div class="table-wrapper">
          <table id="classes-table" class="data-table">
            <thead>
              <tr>
                <th>STT</th>
                <th>M√£ l·ªõp</th>
                <th>T√™n l·ªõp</th>
                <th>Sƒ© s·ªë</th>
                <th>Hi·ªán t·∫°i</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="5" class="empty-state">
                  <div class="empty-icon">üè´</div>
                  <p>Ch∆∞a c√≥ d·ªØ li·ªáu l·ªõp</p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <p class="table-note">üí° Double click v√†o l·ªõp ƒë·ªÉ xem chi ti·∫øt h·ªçc sinh</p>
      </section>
    </div>
  </div>

  <!-- Modal xem h·ªçc sinh trong l·ªõp -->
  <div id="class-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Danh s√°ch h·ªçc sinh l·ªõp <span id="class-modal-title"></span></h3>
        <button class="close-btn">√ó</button>
      </div>
      <div class="modal-body" id="class-modal-body">
        <div class="loading-state">
          <div class="spinner"></div>
          <p>ƒêang t·∫£i...</p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary">ƒê√≥ng</button>
      </div>
    </div>
  </div>

  <!-- Modal ch·ªânh s·ª≠a l·ªõp -->
  <div id="edit-modal" class="modal">
    <div class="modal-content modal-small">
      <div class="modal-header">
        <h3>Ch·ªânh s·ª≠a ph√¢n l·ªõp h·ªçc sinh</h3>
        <button class="close-btn">√ó</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="edit-class-select">Ch·ªçn l·ªõp m·ªõi:</label>
          <select id="edit-class-select" class="form-select">
            <option value="">-- B·ªè ph√¢n l·ªõp --</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary">H·ªßy</button>
        <button id="edit-confirm" class="btn btn-primary">X√°c nh·∫≠n</button>
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div id="loading-overlay" class="loading-overlay">
    <div class="loading-content">
      <div class="spinner-large"></div>
      <p>ƒêang x·ª≠ l√Ω...</p>
    </div>
  </div>

  <script>
    // H√†m m·ªü/ƒë√≥ng modal (th√™m class .show ƒë·ªÉ hi·ªÉn th·ªã m∆∞·ª£t)
    function openModal(id) {
      const modal = document.getElementById(id);
      modal.classList.add('show');
    }

    function closeModal(id) {
      const modal = document.getElementById(id);
      modal.classList.remove('show');
    }

    // ƒê√≥ng modal khi click ngo√†i
    window.onclick = function(event) {
      if (event.target.classList.contains('modal')) {
        event.target.classList.remove('show');
      }
    }

    // G√°n s·ª± ki·ªán cho c√°c n√∫t close
    document.querySelectorAll('.close-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        btn.closest('.modal').classList.remove('show');
      });
    });
  </script>

  <script src="/js/PhanLop.js"></script>
</body>
</html>