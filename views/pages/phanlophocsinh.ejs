<!-- views/pages/phanlophocsinh.ejs -->
<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Phân lớp học sinh cho khối</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11" />
<style>
  :root{
    --navy-900: #071428;
    --navy-700: #0a1d37;
    --navy-600: #15345a;
    --accent: #2b6ea3;
    --muted: #9fb0c8;
    --card: #ffffff;
    --bg: #f4f7fb;
    --radius: 10px;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background:var(--bg);
    color:var(--navy-900);
    -webkit-font-smoothing:antialiased;
  }
  header{
    background: linear-gradient(90deg,var(--navy-900), var(--navy-700));
    color:#fff;
    padding:22px 28px;
    text-align:center;
    font-size:22px;
    font-weight:700;
    box-shadow: 0 3px 10px rgba(9,18,33,0.08);
  }
  main{padding:22px 32px}
  .controls{display:flex;flex-wrap:wrap;gap:12px;align-items:center}
  .controls label{font-weight:600;color:var(--navy-700)}
  select,input[type=number]{padding:8px 10px;border-radius:8px;border:1px solid #d7e2ef;background:#fff;min-width:140px}
  input[type=number]{width:110px}
  .controls button{background:var(--navy-700);color:#fff;border:none;padding:9px 14px;border-radius:8px;cursor:pointer;font-weight:600}
  .controls button:hover{background:var(--navy-600)}

  .panels{display:grid;grid-template-columns:1fr 420px;gap:20px;margin-top:18px}
  .students-panel,.classes-panel{background:var(--card);padding:16px;border-radius:var(--radius);box-shadow:0 6px 18px rgba(11,28,50,0.06)}
  h3{margin:0 0 10px 0;color:var(--navy-700)}

  table.grid{width:100%;border-collapse:collapse;font-size:14px}
  table.grid thead th{background:linear-gradient(90deg,var(--navy-700),var(--navy-600));color:#fff;padding:10px;border-radius:6px}
  table.grid th, table.grid td{padding:10px;border-bottom:1px solid #eef5fb;text-align:left}
  table.grid tbody tr:hover td{background:#fbfdff}
  .text-center{text-align:center;color:var(--muted)}

  /* modal */
  .modal{display:none;position:fixed;inset:0;background:rgba(4,10,20,0.45);align-items:center;justify-content:center}
  .modal-content{background:var(--card);width:720px;max-width:92%;padding:18px;border-radius:12px;box-shadow:0 10px 30px rgba(8,20,40,0.3)}
  .close{float:right;font-size:20px;cursor:pointer}

  /* responsive */
  @media (max-width:900px){
    .panels{grid-template-columns:1fr}
    select,input[type=number]{min-width:unset;width:100%}
    .controls{gap:8px}
  }
</style>
</head>
<body>
<header>Phân lớp học sinh cho khối</header>
<main>
  <section>
    <div class="controls">
      <label>Năm học:</label>
      <select id="namhoc-select">
        <% namHocList.forEach(n => { %>
          <option value="<%= n %>" <%= n===selectedNamHoc ? 'selected' : '' %>><%= n %></option>
        <% }) %>
      </select>

      <label>Khối:</label>
      <select id="khoi-select">
        <% khoiList.forEach(k => { %>
          <option value="<%= k.MaKhoi %>" <%= (k.MaKhoi === selectedKhoi) ? 'selected' : '' %>><%= k.TenKhoi %></option>
        <% }) %>
      </select>

      <label>Sỉ số tối đa mỗi lớp:</label>
      <input type="number" id="max-size" min="1" value="35" />

      <button id="load-students">Tải học sinh</button>
      <button id="auto-assign">Phân bổ tự động</button>
      <button id="save-assign">Lưu phân bổ</button>
    </div>

    <div class="panels">
      <div class="students-panel">
        <h3>Danh sách học sinh</h3>
        <table id="students-table" class="grid">
          <thead>
            <tr><th>STT</th><th>Mã</th><th>Tên</th><th>Tổ hợp</th><th>Trạng thái</th><th>Lớp hiện tại</th></tr>
          </thead>
          <tbody>
            <tr><td colspan="6" class="text-center">Chưa có dữ liệu</td></tr>
          </tbody>
        </table>
      </div>

      <div class="classes-panel">
        <h3>Danh sách lớp</h3>
        <table id="classes-table" class="grid">
          <thead>
            <tr><th>STT</th><th>Mã lớp</th><th>Tên lớp</th><th>Sĩ số</th><th>Học sinh</th></tr>
          </thead>
          <tbody>
            <tr><td colspan="5" class="text-center">Chưa có dữ liệu</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>
</main>

<div id="class-modal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h3>Danh sách học sinh lớp <span id="class-modal-title"></span></h3>
    <div id="class-modal-body">Đang tải...</div>
  </div>
</div>

<script src="/js/PhanLop.js"></script>
</body>
</html>